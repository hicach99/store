{% load functions %}
<section class="cartPageSection woocommerce">
  <div class="container">
    <div class="row">
      <div class="col-lg-12">
        <div class="cartHeader">
          <h3>Your Cart Items</h3>
        </div>
      </div>
      <div class="col-lg-12">
        <table class="shop_table cart_table">
          <thead>
            <tr>
              <th class="product-thumbnail">Item Name</th>
              <th class="product-name">&nbsp;</th>
              <th class="product-price">Price</th>
              <th class="product-quantity">Quantity</th>
              <th class="product-subtotal">Total</th>
              <th class="product-remove">&nbsp;</th>
            </tr>
          </thead>
          <tbody>
            {% if cart %}
            {% if cart|length != 0 %} 
                {% for item_id in cart %}
                {% for item in item_id %}
                    <tr>
                    <td class="product-thumbnail">
                        <a href="{% url 'product_details' item.product.slug %}"><img src="{{ item.product.get_images.0.image.url }}" alt="{{ item.product.name }}"  /></a>
                    </td>
                    <td class="product-name">
                        <a href="{% url 'product_details' item.product.slug %}">{{item.product.name|capitalize}}</a>
                        <span>
                            {% for property in item.properties %},&nbsp;&nbsp;{{ property.name }}{% endfor %}
                        </span>
                    </td>
                    <td class="product-price">
                        <div class="pi01Price">
                        <ins>{{ item.product.price|convert:request }}</ins> 
                        </div>
                    </td>
                    <td class="product-quantity">
                        <div class="quantity clearfix">
                        <button type="button" name="btnMinus" class="qtyBtn btnMinus">_</button>
                        <input type="number" class="carqty input-text qty text" name="quantity" data-id="{{item.product.id}}" data-properties="{% for property in item.properties %}{{ property.id }},{% endfor %}" value="{{ item.quantity }}" />
                        <button type="button" name="btnPlus" class="qtyBtn btnPlus">+</button>
                        </div>
                    </td>
                    <td class="product-subtotal">
                        <div class="pi01Price">
                        <ins>{{ item.total_price|convert:request }}</ins>
                        </div>
                    </td>
                    <td class="product-remove">
                        <a href="{% url 'remove_cart' %}?id={{item.product.id}}&properties={% for property in item.properties %}{{ property.id }},{% endfor %}"  class="remove"><span></span></a>
                    </td>
                    </tr>
                {% endfor %}
                {% endfor %}
            {% endif %}
            {% endif %}
          </tbody>
          <tfoot>
            <tr class="actions">
              <td colspan="2" class="text-start">
                <a href="{% url 'shop' %}" class="ulinaBTN"><span>Continue Shopping</span></a>
                <p class="ErrorCart" style="color: red; float: right;text-align: justify;padding: 20px;"></p>
              </td>
              <td colspan="4" class="text-end">
                <a href="javascript:void(0)" class="ulinaBTN2 UpdateCart">Update Cart</a>
                <a href="{% url 'clear_cart' %}" class="ulinaBTN2 ClearCArt">Clear All</a>
              </td>
          </tfoot>
        </table>
      </div>
    </div>
    <div class="row cartAccessRow">
      <div class="col">
        <div class="cartCoupon">
          <h3>Have A Coupon Code?</h3>
          <input type="text" name="coupon_code" class="input-text" id="coupon_code" value="" placeholder="Write your Coupon Code" />
          <button type="submit" class="ulinaBTN" name="apply_coupon" value="Apply Code"><span>Apply Code</span></button>
        </div>
      </div>
      <div class="col">
        <div class="col-sm-12 cart_totals">
          <table class="shop_table shop_table_responsive">
            <tbody>
              <tr class="cart-subtotal">
                <th>Subtotal</th>
                <td data-title="Subtotal">
                  <div class="pi01Price">
                    <ins>{{cart.get_total_price|convert:request }}</ins>
                  </div>
                </td>
              </tr>
              <tr class="cart-shipping">
                <th>Shipping</th>
                <td data-title="Subtotal">
                  <div class="pi01Price">
                    <ins>Free</ins>
                  </div>
                </td>
              </tr>
              <tr class="order-total">
                <th>Grand Total</th>
                <td data-title="Subtotal">
                  <div class="pi01Price">
                    <ins>{{cart.get_total_price|convert:request }}</ins>
                  </div>
                </td>
              </tr>
            </tbody>
          </table>
          <a href="{% url 'checkout' %}" class="checkout-button ulinaBTN"><span>Proceed to checkout</span></a>
        </div>
      </div>
    </div>
  </div>
</section>
